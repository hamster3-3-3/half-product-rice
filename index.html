<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç±³é£¯æ„Ÿå®˜è©•æ¸¬å„€è¡¨æ¿ | Rice Sensory Evaluation Dashboard</title>
    
    <!-- æ‰€æœ‰çš„ CSS å’Œ JS åº«éƒ½é€é CDN è¼‰å…¥ï¼Œéå¸¸é©åˆéœæ…‹ç¶²ç«™è¨—ç®¡ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- ç§»é™¤ QR Code åº« -->
    
    <style>
        /* è‡ªå®šç¾©æ¨£å¼ */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f5f5f4; }
        ::-webkit-scrollbar-thumb { background: #d6d3d1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #a8a29e; }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px; 
            margin-left: auto;
            margin-right: auto;
            height: 350px; 
            max-height: 400px;
        }
        @media (max-width: 640px) {
            .chart-container { height: 280px; }
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px; 
            height: 18px;
            border-radius: 50%;
            background: #0d9488;
            cursor: pointer;
            box-shadow: 0 0 4px rgba(0, 0, 0, 0.4);
            margin-top: -8px; 
        }
        input[type="range"] {
             height: 4px;
             margin-top: 4px;
        }
    </style>
</head>
<body class="bg-stone-50 text-stone-800 font-sans leading-relaxed selection:bg-teal-100 selection:text-teal-900">

    <!-- Header & Navigation -->
    <header class="bg-white border-b border-stone-200 shadow-sm sticky top-0 z-50">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center space-x-3">
                <div class="w-10 h-10 bg-teal-600 rounded-full flex items-center justify-center text-white font-bold text-xl">ç±³</div>
                <div>
                    <h1 class="text-lg md:text-xl font-bold text-stone-900 tracking-tight">ç±³é£¯æ„Ÿå®˜è©•æ¸¬</h1>
                    <p class="text-xs text-stone-500 uppercase tracking-wider hidden sm:block">Rice Blind Tasting Assessment</p>
                </div>
            </div>
            <div class="flex space-x-2 sm:space-x-3">
                
                <!-- ç§»é™¤ QR Code æŒ‰éˆ• -->

                <button id="resetBtn" class="text-sm text-stone-500 hover:text-teal-600 transition-colors flex items-center gap-1 p-2 rounded-lg hover:bg-stone-100">
                    <span>&#10227;</span> <span class="hidden sm:inline">é‡ç½®</span>
                </button>
                
                <!-- è¼¸å‡ºæ•¸æ“šæŒ‰éˆ• (æ”¹ç‚º CSV ä¸‹è¼‰) -->
                <button id="submitBtn" class="bg-teal-600 hover:bg-teal-700 text-white text-sm font-medium py-2 px-3 sm:px-4 rounded-lg shadow-md transition-colors flex items-center gap-1">
                    <!-- ä¸‹è¼‰åœ–æ¨™ -->
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L10 11.586l1.293-1.293a1 1 0 111.414 1.414l-2 2a1 1 0 01-1.414 0l-2-2a1 1 0 010-1.414z" clip-rule="evenodd" />
                        <path fill-rule="evenodd" d="M10 2a1 1 0 011 1v7a1 1 0 11-2 0V3a1 1 0 011-1z" clip-rule="evenodd" />
                    </svg>
                    <span id="submitBtnText">ä¸‹è¼‰ CSV è¡¨æ ¼</span>
                </button>
            </div>
        </div>
    </header>

    <main class="container mx-auto px-4 py-6 md:py-8 space-y-8 md:space-y-12">

        <!-- Intro Section -->
        <section class="max-w-4xl mx-auto text-center space-y-3">
            <h2 class="text-2xl md:text-3xl font-bold text-stone-800">åŠæˆå“(ç±³é£¯)ç›²æ¸¬è©•åˆ†æ¨™æº–</h2>
            <p class="text-base text-stone-600 max-w-2xl mx-auto">
                è«‹é€éå…­å¤§æ„Ÿå®˜æŒ‡æ¨™ï¼ˆå¤–è§€ã€æ°£å‘³ã€è»Ÿç¡¬ã€ç²˜åº¦ã€å½ˆåŠ›ã€å‘³é“ï¼‰å°æ¨£å“é€²è¡Œå…¨æ–¹ä½è©•ä¼°ã€‚
            </p>
        </section>

        <!-- Dashboard Grid: Mobile-first stacking, then 2 columns on desktop -->
        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
            
            <!-- Left Column (5/12 width on large screens): Input Form (Priority on mobile) -->
            <div class="lg:col-span-5 order-first lg:order-none space-y-6">
                <div class="bg-white rounded-2xl shadow-xl border border-stone-200 p-5 sm:p-6">
                    <div class="flex items-center justify-between mb-6">
                        <h3 class="text-xl font-bold text-teal-800 flex items-center gap-2">
                            <span>&#9998;</span> è©•æ¸¬æ•¸æ“šè¼¸å…¥
                        </h3>
                        <span class="text-xs font-mono bg-stone-100 text-stone-500 px-2 py-1 rounded" id="currentSampleIdDisplay">Sample: C-03 (æ¸¬è©¦)</span>
                    </div>

                    <!-- Meta Data -->
                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mb-6">
                        <div>
                            <label for="input-assessor" class="block text-xs font-semibold text-stone-500 mb-1">è©•æ¸¬è€… (Assessor)</label>
                            <input type="text" id="input-assessor" value="è©•æ¸¬å“¡ C" class="w-full bg-stone-50 border border-stone-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-teal-500 transition-colors">
                        </div>
                        <div>
                            <label for="input-id" class="block text-xs font-semibold text-stone-500 mb-1">æ¨£å“ç·¨è™Ÿ (ID)</label>
                            <input type="text" id="input-id" value="C-03 (æ¸¬è©¦)" class="w-full bg-stone-50 border border-stone-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-teal-500 transition-colors">
                        </div>
                    </div>

                    <div class="space-y-5">
                        <!-- Appearance -->
                        <div>
                            <div class="flex justify-between mb-1">
                                <label class="text-sm font-medium text-stone-700">å¤–è§€ (Appearance)</label>
                                <span class="text-sm font-bold text-teal-600" id="val-appearance">3</span>
                            </div>
                            <input type="range" min="1" max="5" step="1" value="3" id="input-appearance" class="w-full h-2 bg-stone-200 rounded-lg appearance-none cursor-pointer accent-teal-600">
                            <p class="text-xs text-stone-400 mt-1">å®Œæ•´åº¦ã€è‰²æ¾¤ã€å…‰æ¾¤</p>
                        </div>

                        <!-- Aroma -->
                        <div>
                            <div class="flex justify-between mb-1">
                                <label class="text-sm font-medium text-stone-700">æ°£å‘³ (Aroma)</label>
                                <span class="text-sm font-bold text-teal-600" id="val-aroma">3</span>
                            </div>
                            <input type="range" min="1" max="5" step="1" value="3" id="input-aroma" class="w-full h-2 bg-stone-200 rounded-lg appearance-none cursor-pointer accent-teal-600">
                            <p class="text-xs text-stone-400 mt-1">ç±³é£¯é¦™å‘³ã€æ–°é®®åº¦</p>
                        </div>

                        <!-- Texture -->
                        <div>
                            <div class="flex justify-between mb-1">
                                <label class="text-sm font-medium text-stone-700">è»Ÿç¡¬ (Texture)</label>
                                <span class="text-sm font-bold text-teal-600" id="val-texture">3</span>
                            </div>
                            <input type="range" min="1" max="5" step="1" value="3" id="input-texture" class="w-full h-2 bg-stone-200 rounded-lg appearance-none cursor-pointer accent-teal-600">
                            <p class="text-xs text-stone-400 mt-1">ç±³ç²’è»Ÿç¡¬åº¦</p>
                        </div>

                        <!-- Viscosity -->
                        <div>
                            <div class="flex justify-between mb-1">
                                <label class="text-sm font-medium text-stone-700">ç²˜åº¦ (Viscosity)</label>
                                <span class="text-sm font-bold text-teal-600" id="val-viscosity">3</span>
                            </div>
                            <input type="range" min="1" max="5" step="1" value="3" id="input-viscosity" class="w-full h-2 bg-stone-200 rounded-lg appearance-none cursor-pointer accent-teal-600">
                            <p class="text-xs text-stone-400 mt-1">ç±³é£¯é»æ€§ã€æŠ±åœ˜æ€§</p>
                        </div>

                        <!-- Elasticity -->
                        <div>
                            <div class="flex justify-between mb-1">
                                <label class="text-sm font-medium text-stone-700">å½ˆåŠ› (Elasticity)</label>
                                <span class="text-sm font-bold text-teal-600" id="val-elasticity">3</span>
                            </div>
                            <input type="range" min="1" max="5" step="1" value="3" id="input-elasticity" class="w-full h-2 bg-stone-200 rounded-lg appearance-none cursor-pointer accent-teal-600">
                            <p class="text-xs text-stone-400 mt-1">ç±³é£¯å½ˆæ€§ã€å’€åš¼æ„Ÿ</p>
                        </div>

                        <!-- Taste -->
                        <div>
                            <div class="flex justify-between mb-1">
                                <label class="text-sm font-medium text-stone-700">å‘³é“ (Taste)</label>
                                <span class="text-sm font-bold text-teal-600" id="val-taste">3</span>
                            </div>
                            <input type="range" min="1" max="5" step="1" value="3" id="input-taste" class="w-full h-2 bg-stone-200 rounded-lg appearance-none cursor-pointer accent-teal-600">
                            <p class="text-xs text-stone-400 mt-1">ç±³é£¯ç”œåº¦ã€é®®å‘³</p>
                        </div>
                    </div>

                    <div class="mt-8 pt-6 border-t border-stone-200">
                        <label for="input-score" class="block text-sm font-bold text-stone-700 mb-2">æ•´é«”åˆ†æ•¸ (Overall Score)</label>
                        <div class="flex items-center gap-4">
                            <input type="number" id="input-score" value="75" min="0" max="100" class="w-24 text-2xl font-bold text-center text-teal-700 border-2 border-teal-100 rounded-lg py-2 focus:outline-none focus:border-teal-500">
                            <span class="text-stone-400">/ 100</span>
                        </div>
                    </div>

                     <div class="mt-6">
                        <label for="input-comments" class="block text-sm font-bold text-stone-700 mb-2">æ¨£å“è©•åƒ¹å…§å®¹ (Comments)</label>
                        <textarea id="input-comments" class="w-full h-24 bg-stone-50 border border-stone-200 rounded-lg p-3 text-sm focus:outline-none focus:border-teal-500 resize-none" placeholder="æè¿°å„ªç¼ºé»ã€ç‰¹æ®Šé¢¨å‘³..."></textarea>
                    </div>
                </div>
            </div>

            <!-- Right Column (7/12 width on large screens): Visualization (Second on mobile, next to form on desktop) -->
            <div class="lg:col-span-7 order-last lg:order-none space-y-6">
                
                <!-- Radar Chart Card -->
                <div class="bg-white rounded-2xl shadow-xl border border-stone-200 p-5 sm:p-6 flex flex-col h-full">
                    <div class="mb-4">
                        <h3 class="text-xl font-bold text-teal-800">æ„Ÿå®˜è¼ªå»“åˆ†æ (Sensory Profile)</h3>
                    </div>
                    
                    <div class="flex-grow flex items-center justify-center bg-stone-50 rounded-xl p-4 border border-stone-100">
                        <div class="chart-container">
                            <canvas id="radarChart"></canvas>
                        </div>
                    </div>

                    <div class="mt-4 flex justify-center gap-2 text-center text-xs text-stone-500">
                         <div class="flex items-center justify-center gap-1">
                            <span class="w-3 h-3 rounded-full bg-teal-600 border border-teal-800"></span> ç•¶å‰è©•æ¸¬æ¨£å“
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ç§»é™¤ QR Code Modal/Section -->
        <!-- ç§»é™¤ Submission Feedback Modal -->

        <!-- Reference Guide (Scoring Notes) -->
        <section class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div class="bg-red-50 border border-red-100 rounded-xl p-5 hover:shadow-md transition-shadow">
                <div class="flex items-center gap-3 mb-2">
                    <span class="flex items-center justify-center w-8 h-8 rounded-full bg-red-100 text-red-600 font-bold">1</span>
                    <h4 class="font-bold text-red-800">æ¥µå·® (Poor)</h4>
                </div>
                <p class="text-sm text-red-700 leading-snug">ç„¡æ³•æ¥å—çš„å“è³ªæˆ–ç‰¹æ€§ã€‚ä¾‹å¦‚ï¼šæœ‰ç•°å‘³ã€å¤¾ç”Ÿã€è‰²æ¾¤ç°æš—ã€‚</p>
            </div>

            <div class="bg-yellow-50 border border-yellow-100 rounded-xl p-5 hover:shadow-md transition-shadow">
                 <div class="flex items-center gap-3 mb-2">
                    <span class="flex items-center justify-center w-8 h-8 rounded-full bg-yellow-100 text-yellow-700 font-bold">3</span>
                    <h4 class="font-bold text-yellow-800">æ™®é€š (Average)</h4>
                </div>
                <p class="text-sm text-yellow-800 leading-snug">å“è³ªå°šå¯ï¼Œé”åˆ°åŸºæœ¬é£Ÿç”¨æ¨™æº–ï¼Œä½†æ²’æœ‰çªå‡ºçš„å„ªé»æˆ–æ˜é¡¯çš„è¨˜æ†¶é»ã€‚</p>
            </div>

             <div class="bg-teal-50 border border-teal-100 rounded-xl p-5 hover:shadow-md transition-shadow">
                 <div class="flex items-center gap-3 mb-2">
                    <span class="flex items-center justify-center w-8 h-8 rounded-full bg-teal-100 text-teal-700 font-bold">5</span>
                    <h4 class="font-bold text-teal-800">æ¥µä½³ (Excellent)</h4>
                </div>
                <p class="text-sm text-teal-800 leading-snug">é ‚ç´šå“è³ªï¼Œç‰¹æ€§å®Œç¾ã€‚ä¾‹å¦‚ï¼šå…‰æ¾¤èª˜äººã€é¦™æ°£æ¿ƒéƒã€å£æ„Ÿçµ•ä½³ã€‚</p>
            </div>
        </section>

    </main>

    <footer class="bg-stone-800 text-stone-400 py-6 mt-12">
        <div class="container mx-auto px-4 text-center text-sm">
            <p>&copy; 2025 Rice Blind Tasting Assessment System.</p>
        </div>
    </footer>

    <!-- Javascript Logic -->
    <script>
        // ç§»é™¤ Google Apps Script URL è¨­å®š
        
        let currentSample = {
            assessor: "è©•æ¸¬å“¡ C",
            id: "C-03 (æ¸¬è©¦)",
            name: "ç•¶å‰è©•æ¸¬",
            scores: { appearance: 3, aroma: 3, texture: 3, viscosity: 3, elasticity: 3, taste: 3 },
            total: 75,
            comments: ""
        };

        let radarChartInstance = null;
        let isSubmitting = false; // æ­¤è®Šæ•¸å¯ä»¥ä¿ç•™ç”¨æ–¼é˜²æ­¢é‡è¤‡ä¸‹è¼‰ï¼Œä½†å…¶æ„ç¾©å·²æ”¹è®Š

        function getCurrentSampleData() {
            // å¾è¼¸å…¥æ¬„ä½æŠ“å–æœ€æ–°çš„æ•¸æ“š
            currentSample.assessor = document.getElementById('input-assessor').value.trim();
            currentSample.id = document.getElementById('input-id').value.trim();
            currentSample.total = parseInt(document.getElementById('input-score').value) || 0;
            currentSample.comments = document.getElementById('input-comments').value.trim(); 
            
            const inputs = ['appearance', 'aroma', 'texture', 'viscosity', 'elasticity', 'taste'];
            inputs.forEach(key => {
                // ç¢ºä¿æ•¸å€¼æ˜¯æ•´æ•¸
                currentSample.scores[key] = Math.round(parseFloat(document.getElementById(`input-${key}`).value));
            });

            return currentSample;
        }

        function initCharts() {
            const ctxRadar = document.getElementById('radarChart').getContext('2d');
            radarChartInstance = new Chart(ctxRadar, {
                type: 'radar',
                data: {
                    labels: ['å¤–è§€', 'æ°£å‘³', 'è»Ÿç¡¬', 'ç²˜åº¦', 'å½ˆåŠ›', 'å‘³é“'],
                    datasets: [
                        {
                            label: 'ç•¶å‰è©•æ¸¬',
                            data: Object.values(currentSample.scores),
                            borderColor: 'rgba(13, 148, 136, 1)', 
                            backgroundColor: 'rgba(13, 148, 136, 0.4)',
                            borderWidth: 2,
                            pointBackgroundColor: '#fff',
                            pointBorderColor: 'rgba(13, 148, 136, 1)',
                            pointHoverBackgroundColor: '#fff',
                            pointHoverBorderColor: 'rgba(13, 148, 136, 1)'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        r: {
                            min: 0,
                            max: 5,
                            ticks: { stepSize: 1, display: false },
                            grid: { color: 'rgba(0, 0, 0, 0.05)' },
                            angleLines: { color: 'rgba(0, 0, 0, 0.05)' },
                            pointLabels: {
                                font: { size: 12, family: "'Noto Sans TC', sans-serif" },
                                color: '#44403c'
                            }
                        }
                    },
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            backgroundColor: 'rgba(255, 255, 255, 0.9)',
                            titleColor: '#111',
                            bodyColor: '#333',
                            borderColor: '#e5e7eb',
                            borderWidth: 1,
                            padding: 10
                        }
                    }
                }
            });
        }
        
        /**
         * åŒ¯å‡ºæ•¸æ“šç‚º CSV æ–‡ä»¶ (Excel ç›¸å®¹)
         */
        function exportToCsv() {
            if (isSubmitting) return; // ä½¿ç”¨ isSubmitting ä¾†é˜²æ­¢é‡è¤‡é»æ“Š
            
            const data = getCurrentSampleData();
            
            // åŸºç¤è³‡æ–™é©—è­‰
            if (!data.assessor || !data.id) {
                 // ç°¡å–®çš„é€šçŸ¥
                 alert('è«‹å¡«å¯«è©•æ¸¬è€…åŠæ¨£å“ç·¨è™Ÿï¼');
                 return;
            }

            isSubmitting = true;
            const submitBtnText = document.getElementById('submitBtnText');
            const originalText = submitBtnText.innerText;
            
            submitBtnText.innerText = 'æ­£åœ¨æº–å‚™...';

            // 1. å®šç¾© CSV æ¨™é ­
            const headers = [
                "è©•æ¸¬è€…", "æ¨£å“ç·¨è™Ÿ", "å¤–è§€", "æ°£å‘³", "è»Ÿç¡¬", "ç²˜åº¦", "å½ˆåŠ›", "å‘³é“", "æ•´é«”åˆ†æ•¸", "æ¨£å“è©•åƒ¹å…§å®¹"
            ];
            
            // 2. æº–å‚™æ•¸æ“šè¡Œ
            // ç¢ºä¿è©•åƒ¹å…§å®¹ (comments) ä¸­çš„æ›è¡Œç¬¦ (newlines) è¢«ç§»é™¤æˆ–æ›¿æ›ï¼Œ
            // ä¸¦ä¸”å¦‚æœå…§å®¹åŒ…å«é€—è™Ÿ (,) æˆ–é›™å¼•è™Ÿ (")ï¼Œå‰‡éœ€è¦ç”¨é›™å¼•è™ŸåŒ…è£¹ï¼Œ
            // ä¸”å…§éƒ¨çš„é›™å¼•è™Ÿéœ€è¦é€¸å‡º (Escape) ç‚ºå…©å€‹é›™å¼•è™Ÿ ("")ã€‚
            const commentsCsvSafe = `"${data.comments.replace(/"/g, '""').replace(/\n/g, ' ') }"`;

            const row = [
                data.assessor,
                data.id,
                data.scores.appearance,
                data.scores.aroma,
                data.scores.texture,
                data.scores.viscosity,
                data.scores.elasticity,
                data.scores.taste,
                data.total,
                commentsCsvSafe // å·²è™•ç†éé›™å¼•è™Ÿå’Œæ›è¡Œç¬¦
            ];
            
            // 3. çµ„åˆ CSV å…§å®¹
            const csvContent = headers.join(',') + '\n' + row.join(',');
            
            // 4. å‰µå»º Blob ä¸¦ä¸‹è¼‰
            // ä½¿ç”¨ '\ufeff' (BOM) ç¢ºä¿ Excel èƒ½å¤ æ­£ç¢ºè­˜åˆ¥ UTF-8 ç·¨ç¢¼çš„ä¸­æ–‡ã€‚
            const blob = new Blob(['\ufeff', csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.setAttribute('href', url);
            
            // æª”æ¡ˆåç¨±ä½¿ç”¨æ¨£å“ç·¨è™Ÿå’Œæ™‚é–“æˆ³
            const timestamp = new Date().toISOString().slice(0, 10).replace(/-/g, ''); // YYYYMMDD
            const filename = `Rice_Evaluation_${data.id.replace(/\s/g, '_')}_${timestamp}.csv`;
            a.setAttribute('download', filename);
            
            // æ¨¡æ“¬é»æ“Šä¸‹è¼‰
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);

            // æä¾›è¦–è¦ºåé¥‹
            submitBtnText.innerText = 'ä¸‹è¼‰å®Œæˆ! ğŸ’¾';
            setTimeout(() => { 
                submitBtnText.innerText = originalText; 
                isSubmitting = false; // é‡ç½®ç‹€æ…‹
            }, 2000);
        }

        // --- Listeners & Init ---
        function setupListeners() {
            const inputs = ['appearance', 'aroma', 'texture', 'viscosity', 'elasticity', 'taste'];
            inputs.forEach(key => {
                const slider = document.getElementById(`input-${key}`);
                const display = document.getElementById(`val-${key}`);
                slider.addEventListener('input', (e) => {
                    const val = Math.round(parseFloat(e.target.value)); 
                    display.innerText = val;
                    currentSample.scores[key] = val;
                    updateDashboard();
                });
            });

            ['input-score', 'input-assessor', 'input-id', 'input-comments'].forEach(id => {
                 document.getElementById(id).addEventListener('input', updateDashboard);
            });

            document.getElementById('resetBtn').addEventListener('click', () => {
                inputs.forEach(key => {
                    document.getElementById(`input-${key}`).value = 3;
                    document.getElementById(`val-${key}`).innerText = 3;
                });
                document.getElementById('input-score').value = 75;
                document.getElementById('input-assessor').value = "è©•æ¸¬å“¡ C";
                document.getElementById('input-id').value = "C-03 (æ¸¬è©¦)";
                document.getElementById('input-comments').value = "";
                updateDashboard();
            });

            // å°‡æäº¤æŒ‰éˆ•çš„ç›£è½å™¨æ”¹ç‚º CSV åŒ¯å‡ºå‡½æ•¸
            document.getElementById('submitBtn').addEventListener('click', exportToCsv);
            
            // ç§»é™¤ QR Code ç›¸é—œçš„ç›£è½å™¨å’Œå‡½æ•¸
        }

        function updateDashboard() {
            const currentData = getCurrentSampleData();
            document.getElementById('currentSampleIdDisplay').innerText = `Sample: ${currentData.id}`;
            radarChartInstance.data.datasets[0].data = Object.values(currentData.scores);
            radarChartInstance.update();
        }

        window.addEventListener('DOMContentLoaded', () => {
            // åˆå§‹åŒ–è¡¨å–®å€¼
            document.getElementById('input-assessor').value = currentSample.assessor;
            document.getElementById('input-id').value = currentSample.id;
            document.getElementById('input-score').value = currentSample.total;
            
             const inputs = ['appearance', 'aroma', 'texture', 'viscosity', 'elasticity', 'taste'];
             inputs.forEach(key => {
                 document.getElementById(`input-${key}`).value = currentSample.scores[key];
                 document.getElementById(`val-${key}`).innerText = currentSample.scores[key];
             });

            initCharts();
            setupListeners();
        });

    </script>
</body>
</html>
